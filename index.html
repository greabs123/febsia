<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Febs IA | Ferramenta de extra√ß√£o</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f3f3f3;
            --bg-card: #cee3f9;
            --bg-surface: #d1d1d1;
            --bg-overlay: rgba(255, 255, 255, 0.8);
            
            --text-primary: #000000;
            --text-secondary: #000000;
            --text-tertiary: #676767;
            --text-muted: #aaaaaa;
            --text-bold: #000000;
            
            --form-bg: #fbfbfb;
            --form-bg-focus: #ffffff;
            --form-border: #cee3f9;
            --form-border-focus: #007AFF;
            --form-placeholder: #cee3f9;
            
            --btn-primary-bg: #007AFF;
            --btn-primary-text: #ffffff;
            --btn-primary-hover: #0056d6;
            
            --btn-secondary-bg: #e9e9e9;
            --btn-secondary-text: #ffffff;
            --btn-secondary-hover: #d1d1d1;
            
            --btn-copy-bg: #007AFF;
            --btn-copy-text: #ffffff;
            --btn-copy-hover: #0056d6;
            
            --btn-reset-bg: #ffffff;
            --btn-reset-text: #303030;
            --btn-reset-hover: #e0e0e0;
            
            --control-header-bg: #007AFF;
            --control-header-text: #ffffff;
            --control-header-hover: #007AFF;
            
            --control-bg: #cee3f9;
            --control-border: #ffffff;
            
            --slider-track: #ffffff;
            --slider-thumb: #007AFF;
            --slider-thumb-hover: #0056d6;
            
            --status-success: #10b981;
            --status-error: #ef4444;
            --status-info: #007AFF;
            --status-warning: #f59e0b;
            
            --accent-color: #8b5cf6;
            --link-color: #007AFF;
            --shadow-color: rgba(0, 0, 0, 0.1);
            
            --mercado-livre: #fee700;
            --amazon: #2d2d2d;
            
            --radius-xs: 4px;
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --radius-2xl: 24px;
            --radius-full: 9999px;
            
            --shadow-subtle: 0 1px 3px var(--shadow-color);
            --shadow-soft: 0 4px 12px var(--shadow-color);
            --shadow-medium: 0 8px 24px var(--shadow-color);
            --shadow-elevated: 0 12px 32px var(--shadow-color);
            
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-mono: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', monospace;
            --font-display: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        body.dark-mode {
            --bg-primary: #202020;
            --bg-secondary: #ffffff;
            --bg-tertiary: #2a2a2a;
            --bg-card: #1c1c1e;
            --bg-surface: #2c2c2e;
            --bg-overlay: rgba(28, 28, 30, 0.8);
            
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-tertiary: #b5b5b5;
            --text-muted: #636366;
            --text-bold: #ffffff;
            
            --form-bg: #2a2a2a;
            --form-bg-focus: #3a3a3a;
            --form-border: #48484a;
            --form-border-focus: #0a84ff;
            --form-placeholder: #636366;
            
            --btn-primary-bg: #0a84ff;
            --btn-primary-text: #ffffff;
            --btn-primary-hover: #409cff;
            
            --btn-secondary-bg: #3a3a3a;
            --btn-secondary-text: #b0b0b0;
            --btn-secondary-hover: #48484a;
            
            --btn-copy-bg: #0a84ff;
            --btn-copy-text: #ffffff;
            --btn-copy-hover: #409cff;
            
            --btn-reset-bg: #2a2a2a;
            --btn-reset-text: #b0b0b0;
            --btn-reset-hover: #3a3a3a;
            
            --control-header-bg: #3a3a3a;
            --control-header-text: #ffffff;
            --control-header-hover: #48484a;
            
            --control-bg: #1c1c1e;
            --control-border: #3a3a3c;
            
            --slider-track: #48484a;
            --slider-thumb: #0a84ff;
            --slider-thumb-hover: #409cff;
            
            --status-success: #30d158;
            --status-error: #ff453a;
            --status-info: #0a84ff;
            --status-warning: #ffd60a;
            
            --accent-color: #bf5af2;
            --link-color: #0a84ff;
            --shadow-color: rgba(0, 0, 0, 0.25);
            
            --mercado-livre: #fee700;
            --amazon: #e68a00;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: var(--font-sans);
            font-size: 13px;
            line-height: 1;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
            transition: background-color var(--transition-slow), color var(--transition-slow);
        }
        
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }
        
        .app-header {
            margin-bottom: 24px;
            position: relative;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid var(--control-border);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--btn-primary-bg), var(--accent-color));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            font-weight: 600;
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
        }
        
        .logo-title {
            font-family: var(--font-display);
            font-size: 18px;
            font-weight: 600;
            letter-spacing: -0.01em;
            color: var(--text-primary);
            line-height: 1.2;
        }
        
        .logo-subtitle {
            font-size: 11px;
            color: var(--text-tertiary);
            font-weight: 400;
            letter-spacing: 0.02em;
        }
        
        .theme-toggle-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .theme-label {
            font-size: 11px;
            color: var(--text-tertiary);
            font-weight: 500;
            letter-spacing: 0.03em;
        }
        
        .theme-toggle {
            position: relative;
            width: 44px;
            height: 22px;
        }
        
        .theme-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--form-border);
            transition: var(--transition-normal);
            border-radius: var(--radius-full);
        }
        
        .theme-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: var(--transition-normal);
            border-radius: 50%;
            box-shadow: var(--shadow-subtle);
        }
        
        input:checked + .theme-slider {
            background: linear-gradient(135deg, var(--btn-primary-bg), var(--accent-color));
        }
        
        input:checked + .theme-slider:before {
            transform: translateX(22px);
        }
        
        .app-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 1024px) {
            .app-content {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }
        
        .card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            border: 1px solid var(--control-border);
            box-shadow: var(--shadow-soft);
            transition: all var(--transition-normal);
            overflow: hidden;
        }
        
        .card:hover {
            box-shadow: var(--shadow-medium);
            border-color: var(--form-border);
        }
        
        .card-no-header {
            padding: 8px;
        }
        
        .card-header {
            padding: 8px 10px;
            border-bottom: 1px solid var(--control-border);
            background: var(--bg-tertiary);
        }
        
        .card-title {
            font-family: var(--font-display);
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: -0.01em;
        }
        
        .card-title-icon {
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--btn-primary-bg), var(--accent-color));
            border-radius: 6px;
            color: white;
            font-size: 11px;
        }
        
        .card-body {
            padding: 8px;
        }
        
        .result-container {
            width: 100%;
            min-height: 280px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            border: 1px dashed var(--control-border);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 24px;
            margin-bottom: 20px;
            transition: all var(--transition-normal);
        }
        
        .result-container.has-image {
            border: 1px solid var(--control-border);
            background: var(--bg-card);
        }
        
        #resultCanvas {
            max-width: 100%;
            max-height: 280px;
            border-radius: var(--radius-md);
            display: none;
            box-shadow: var(--shadow-soft);
        }
        
        .canvas-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            text-align: center;
        }
        
        .placeholder-icon {
            font-size: 40px;
            opacity: 0.3;
            margin-bottom: 6px;
        }
        
        .placeholder-text {
            font-size: 13px;
            color: var(--text-tertiary);
            font-weight: 500;
        }
        
        .placeholder-subtext {
            font-size: 11px;
            color: var(--text-muted);
            max-width: 260px;
            line-height: 1.4;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 2px;
        }
        
        .action-buttons .copy-button,
        .action-buttons .reset-button {
            flex: 1;
            padding: 12px 16px;
            border-radius: var(--radius-md);
            font-family: var(--font-sans);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            min-height: 44px;
        }
        
        #copyImageButton {
            background: var(--btn-copy-bg);
            color: var(--btn-copy-text);
            border: 1px solid var(--btn-copy-bg);
        }
        
        #copyImageButton:hover {
            background: var(--btn-copy-hover);
            border-color: var(--btn-copy-hover);
            transform: translateY(-1px);
        }
        
        #copyImageButton:disabled {
            background: var(--slider-track);
            border-color: var(--slider-track);
            color: var(--text-muted);
        }
        
        #copyTextButton {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--control-border);
        }
        
        #copyTextButton:hover {
            background: var(--bg-tertiary);
            border-color: var(--form-border);
            transform: translateY(-1px);
        }
        
        #copyTextButton:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        #resetButton {
            background: var(--btn-reset-bg);
            color: var(--btn-reset-text);
            border: 1px solid var(--control-border);
        }
        
        #resetButton:hover {
            background: var(--btn-reset-hover);
            border-color: var(--form-border);
            transform: translateY(-1px);
        }
        
        .copy-button-icon {
            font-size: 13px;
        }
        
        .controls-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .control-group {
            background: var(--control-bg);
            border-radius: var(--radius-lg);
            border: 1px solid var(--control-border);
            overflow: hidden;
        }
        
        .control-header {
            padding: 14px 18px;
            background: var(--control-header-bg);
            color: var(--control-header-text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color var(--transition-fast);
        }
        
        .control-header:hover {
            background: var(--control-header-hover);
        }
        
        .control-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--control-header-text);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .control-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-tertiary);
        }
        
        .collapse-icon {
            transition: transform var(--transition-normal);
        }
        
        .control-group.open .collapse-icon {
            transform: rotate(180deg);
        }
        
        .control-content {
            padding: 16px;
            display: none;
        }
        
        .control-group.open .control-content {
            display: block;
            animation: slideDown 0.3s ease-out;
        }
        
        .aspect-controls {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .aspect-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .aspect-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            min-width: 70px;
        }
        
        .aspect-presets {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            flex: 1;
        }
        
        .aspect-button {
            padding: 2px 5px;
            background: var(--bg-card);
            border: 1px solid var(--control-border);
            border-radius: var(--radius-md);
            font-size: 15px;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            min-width: 50px;
            text-align: center;
        }
        
        .aspect-button:hover {
            border-color: var(--btn-primary-bg);
            color: var(--btn-primary-bg);
        }
        
        .aspect-button.active {
            background: var(--btn-primary-bg);
            border-color: var(--btn-primary-bg);
            color: var(--btn-primary-text);
        }
        
        .custom-dimensions {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 12px;
        }
        
        .dimension-input {
            width: 70px;
            padding: 6px 8px;
            background: var(--bg-card);
            border: 1px solid var(--control-border);
            border-radius: var(--radius-md);
            font-family: var(--font-mono);
            font-size: 11px;
            color: var(--text-primary);
            text-align: center;
            transition: all var(--transition-fast);
        }
        
        .dimension-input:focus {
            outline: none;
            border-color: var(--form-border-focus);
        }
        
        .dimension-separator {
            color: var(--text-tertiary);
            font-weight: 500;
        }
        
        .slider-group {
            margin-bottom: 16px;
        }
        
        .slider-group:last-child {
            margin-bottom: 0;
        }
        
        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }
        
        .slider-label-text {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .slider-value {
            font-family: var(--font-mono);
            font-size: 11px;
            color: var(--text-primary);
            font-weight: 500;
        }
        
        .slider {
            width: 100%;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--slider-track);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--slider-thumb);
            border: 2px solid var(--control-bg);
            box-shadow: var(--shadow-subtle);
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .slider::-webkit-slider-thumb:hover {
            background: var(--slider-thumb-hover);
            transform: scale(1.1);
            box-shadow: var(--shadow-soft);
        }
        
        .color-picker-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .color-picker {
            width: 36px;
            height: 36px;
            border: 2px solid var(--control-border);
            border-radius: var(--radius-md);
            cursor: pointer;
            padding: 2px;
            background: var(--control-bg);
            transition: all var(--transition-fast);
        }
        
        .color-picker:hover {
            border-color: var(--btn-primary-bg);
            transform: scale(1.05);
        }
        
        .color-presets {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }
        
        .color-preset {
            width: 22px;
            height: 22px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            border: 2px solid transparent;
            transition: all var(--transition-fast);
        }
        
        .color-preset:hover {
            transform: scale(1.1);
        }
        
        .color-preset.active {
            border-color: var(--btn-primary-bg);
            transform: scale(1.1);
        }
        
        .extractor-section {
            margin-bottom: 5px;
        }
        
        .extractor-section:last-child {
            margin-bottom: 0;
        }
        
        .extractor-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .extractor-title-icon {
            width: 40px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--mercado-livre);
            border-radius: 4px;
            color: #1a1a1a;
            font-size: 14px;
        }
        
        .extractor-input-group {
            margin-bottom: 8px;
        }
        
        .input-with-button {
            display: flex;
            gap: 8px;
        }
        
        .text-input {
            flex: 1;
            padding: 10px 14px;
            background: var(--form-bg);
            border: 1px solid var(--form-border);
            border-radius: var(--radius-md);
            font-family: var(--font-sans);
            font-size: 12px;
            color: var(--text-primary);
            transition: all var(--transition-fast);
        }
        
        .text-input:focus {
            outline: none;
            border-color: var(--form-border-focus);
            background: var(--form-bg-focus);
            box-shadow: 0 0 0 3px rgba(var(--btn-primary-bg-rgb), 0.1);
        }
        
        .text-input::placeholder {
            color: var(--form-placeholder);
        }
        
        .primary-button {
            padding: 10px 16px;
            background: var(--btn-primary-bg);
            color: var(--btn-primary-text);
            border: none;
            border-radius: var(--radius-md);
            font-family: var(--font-sans);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }
        
        .primary-button:hover {
            background: var(--btn-primary-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-soft);
        }
        
        .primary-button:active {
            transform: translateY(0);
        }
        
        .primary-button:disabled {
            background: var(--slider-track);
            color: var(--text-muted);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .mercado-livre-button {
            background: var(--mercado-livre);
            color: #1a1a1a;
        }
        
        .mercado-livre-button:hover {
            background: #f2d600;
        }
        
        .amazon-button {
            background: var(--amazon);
            color: white;
        }
        
        .amazon-button:hover {
            background: #e68a00;
        }
        
        .status-message {
            margin-top: 12px;
            padding: 10px 14px;
            background: var(--form-bg);
            border-radius: var(--radius-md);
            font-size: 11px;
            font-weight: 500;
            display: none;
            animation: slideIn 0.3s ease-out;
            border-left: 3px solid var(--status-info);
        }
        
        .status-success {
            border-left-color: var(--status-success);
        }
        
        .status-error {
            border-left-color: var(--status-error);
        }
        
        .status-info {
            border-left-color: var(--status-info);
        }
        
        .product-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .form-label {
            font-size: 11px;
            font-weight: 700;
            color: var(--text-bold);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .form-label-icon {
            font-size: 12px;
        }
        
        .form-input,
        .form-textarea {
            padding: 10px 14px;
            background: var(--form-bg);
            border: 1px solid var(--form-border);
            border-radius: var(--radius-md);
            font-family: var(--font-sans);
            font-size: 12px;
            color: var(--text-primary);
            transition: all var(--transition-fast);
        }
        
        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--form-border-focus);
            background: var(--form-bg-focus);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 70px;
            line-height: 1.4;
        }
        
        .copyable-area {
            margin-top: 20px;
        }
        
        .copyable-textarea {
            width: 100%;
            min-height: 90px;
            padding: 14px;
            background: var(--form-bg);
            border: 1px solid var(--form-border);
            border-radius: var(--radius-md);
            font-family: var(--font-mono);
            font-size: 11px;
            color: var(--text-primary);
            line-height: 1.5;
            resize: vertical;
            transition: all var(--transition-fast);
            cursor: pointer;
        }
        
        .copyable-textarea:focus {
            outline: none;
            border-color: var(--form-border-focus);
            background: var(--form-bg-focus);
        }
        
        .copyable-textarea.copied {
            border-color: var(--status-success);
            background: rgba(16, 185, 129, 0.1);
        }
        
        .upload-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 20px;
        }
        
        .upload-option {
            background: var(--form-bg);
            border: 1px solid var(--control-border);
            border-radius: var(--radius-lg);
            padding: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all var(--transition-normal);
        }
        
        .upload-option:hover {
            background: var(--bg-card);
            border-color: var(--btn-primary-bg);
            transform: translateY(-2px);
            box-shadow: var(--shadow-soft);
        }
        
        .upload-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--btn-primary-bg), var(--accent-color));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }
        
        .upload-text {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-primary);
            text-align: center;
        }
        
        .upload-button {
            padding: 6px 12px;
            background: var(--btn-primary-bg);
            color: var(--btn-primary-text);
            border: none;
            border-radius: var(--radius-sm);
            font-size: 10px;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .upload-button:hover {
            background: var(--btn-primary-hover);
        }
        
        .url-input-container {
            display: flex;
            gap: 6px;
            margin-top: 8px;
            width: 100%;
        }
        
        .url-input {
            flex: 1;
            padding: 6px 10px;
            background: var(--bg-card);
            border: 1px solid var(--control-border);
            border-radius: var(--radius-sm);
            font-size: 10px;
            color: var(--text-primary);
        }
        
        .url-input:focus {
            outline: none;
            border-color: var(--form-border-focus);
        }
        
        .app-footer {
            margin-top: 32px;
            padding-top: 20px;
            border-top: 1px solid var(--control-border);
            text-align: center;
        }
        
        .footer-text {
            font-size: 11px;
            color: var(--text-tertiary);
            letter-spacing: 0.02em;
        }
        
        .footer-highlight {
            color: var(--link-color);
            font-weight: 500;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-8px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: slideIn 0.3s ease-out;
        }
        
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--form-border);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-tertiary);
        }
        
        @media (max-width: 768px) {
            .app-container {
                padding: 16px;
            }
            
            .app-content {
                gap: 12px;
            }
            
            .card-body {
                padding: 16px;
            }
            
            .upload-options {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .input-with-button {
                flex-direction: column;
            }
            
            .aspect-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .custom-dimensions {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .dimension-input {
                width: 100%;
            }
            
            .header-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
            
            .theme-toggle-container {
                align-self: flex-start;
            }
        }
        
        @media (max-width: 480px) {
            .card-header {
                padding: 14px 16px;
            }
            
            .card-body {
                padding: 14px;
            }
            
            .result-container {
                padding: 20px;
                min-height: 240px;
            }
            
            .aspect-presets {
                flex-wrap: wrap;
            }
            
            .aspect-button {
                min-width: 40px;
                padding: 4px 8px;
                font-size: 10px;
            }
        }
        
        .hidden {
            display: none !important;
        }
        
        .mt-2 { margin-top: 8px; }
        .mt-4 { margin-top: 16px; }
        .mb-4 { margin-bottom: 16px; }
        
        .text-center { text-align: center; }
        .text-muted { color: var(--text-muted); }
        
        .w-full { width: 100%; }
        
        .loading {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid var(--control-border);
            border-top-color: var(--btn-primary-bg);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: var(--radius-md);
            font-size: 12px;
            font-weight: 500;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
            box-shadow: var(--shadow-elevated);
            max-width: 300px;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .notification.success {
            background: var(--status-success);
            color: white;
        }
        
        .notification.error {
            background: var(--status-error);
            color: white;
        }
        
        .notification.info {
            background: var(--status-info);
            color: white;
        }
        
        .price-input-wrapper {
            display: flex;
            align-items: center;
            position: relative;
        }
        
        .price-prefix {
            position: absolute;
            left: 14px;
            color: var(--text-primary);
            font-weight: 500;
            pointer-events: none;
            z-index: 1;
        }
        
        .price-input {
            padding-left: 32px !important;
        }
        
        .extractors-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .extractor-compact {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 12px;
            border: 1px solid var(--control-border);
        }
        
        .extractor-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .extractor-header-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .extractor-header-button {
            padding: 6px 10px;
            font-size: 11px;
            min-width: 70px;
        }
        
        @media (max-width: 768px) {
            .extractors-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-content">
                <div class="logo-container">
                    <div class="logo-icon">ü§ñ</div>
                    <div class="logo-text">
                        <h1 class="logo-title">Febs AI</h1>
                        <p class="logo-subtitle">Ferramenta de extra√ß√£o</p>
                    </div>
                </div>
                
                <div class="theme-toggle-container">
                    <span class="theme-label">TEMA ESCURO</span>
                    <label class="theme-toggle">
                        <input type="checkbox" id="themeToggle">
                        <span class="theme-slider"></span>
                    </label>
                </div>
            </div>
        </header>
        
        <main class="app-content">
            <section class="left-column">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-title-icon">üé®</span>
                            Resultado
                        </h2>
                    </div>
                    <div class="card-body">
                        <div class="result-container" id="resultContainer">
                            <canvas id="resultCanvas"></canvas>
                            <div class="canvas-placeholder">
                                <div class="placeholder-icon">üñºÔ∏è</div>
                                <p class="placeholder-text">Sua imagem aparecer√° aqui</p>
                                <p class="placeholder-subtext">Fa√ßa upload de uma imagem ou extraia de um produto</p>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="copy-button" id="copyImageButton">
                                <span class="copy-button-icon">üìã</span>
                                Copiar imagem
                            </button>
                            <button class="copy-button" id="copyTextButton">
                                <span class="copy-button-icon">üìù</span>
                                Copiar texto
                            </button>
                            <button class="reset-button" id="resetButton">
                                <span>üîÑ</span>
                                Limpar Tudo
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="controls-container">
                    <div class="control-group open" id="sizePositionBlock">
                        <div class="control-header" data-target="sizePositionContent">
                            <div class="control-title">
                                <span class="control-icon">‚ÜîÔ∏è</span>
                                Tamanho, Posi√ß√£o e Propor√ß√£o
                            </div>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="control-content" id="sizePositionContent">
                            <div class="aspect-controls">
                                <div class="aspect-row">
                                    <span class="aspect-label">Propor√ß√£o</span>
                                    <div class="aspect-presets">
                                        <button class="aspect-button active" data-aspect="2:1" data-width="800" data-height="400">2:1</button>
                                        <button class="aspect-button" data-aspect="1.5:1" data-width="750" data-height="500">1.5:1</button>
                                        <button class="aspect-button" data-aspect="1.2:1" data-width="720" data-height="600">1.2:1</button>
                                        <button class="aspect-button" data-aspect="1:1" data-width="800" data-height="800">1:1</button>
                                        <button class="aspect-button" data-aspect="4:3" data-width="800" data-height="600">4:3</button>
                                        <button class="aspect-button" data-aspect="16:9" data-width="800" data-height="450">16:9</button>
                                    </div>
                                </div>
                                
                                <div class="custom-dimensions">
                                    <span class="aspect-label">Personalizado</span>
                                    <input type="number" id="customWidthPixels" class="dimension-input" value="800" min="100" max="2000" step="10">
                                    <span class="dimension-separator">√ó</span>
                                    <input type="number" id="customHeightPixels" class="dimension-input" value="400" min="100" max="2000" step="10">
                                    <button class="primary-button" id="applyCustomPixels" style="padding: 8px 12px;">Aplicar</button>
                                </div>
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Tamanho da imagem</span>
                                    <span class="slider-value" id="sizeValue">80%</span>
                                </div>
                                <input type="range" min="50" max="200" value="80" class="slider" id="sizeSlider">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Posi√ß√£o Horizontal</span>
                                    <span class="slider-value" id="positionXValue">0px</span>
                                </div>
                                <input type="range" min="-100" max="100" value="0" class="slider" id="positionXSlider">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Posi√ß√£o Vertical</span>
                                    <span class="slider-value" id="positionYValue">0px</span>
                                </div>
                                <input type="range" min="-300" max="300" value="0" class="slider" id="positionYSlider">
                            </div>
                            
                            <button class="primary-button w-full mt-2" id="resetPositionButton" style="padding: 8px 12px;">
                                <span>‚Ü∫</span>
                                Resetar Posi√ß√£o
                            </button>
                        </div>
                    </div>
                    
                    <div class="control-group" id="styleBlock">
                        <div class="control-header" data-target="styleContent">
                            <div class="control-title">
                                <span class="control-icon">üé®</span>
                                Estilo
                            </div>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="control-content" id="styleContent">
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Bordas Arredondadas</span>
                                    <span class="slider-value" id="borderValue">30px</span>
                                </div>
                                <input type="range" min="0" max="60" value="30" class="slider" id="borderSlider">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Intensidade da Sombra</span>
                                    <span class="slider-value" id="shadowValue">0px</span>
                                </div>
                                <input type="range" min="0" max="40" value="0" class="slider" id="shadowSlider">
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-group" id="backgroundBlock">
                        <div class="control-header" data-target="backgroundContent">
                            <div class="control-title">
                                <span class="control-icon">üñºÔ∏è</span>
                                Fundo
                            </div>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="control-content" id="backgroundContent">
                            <div class="color-picker-container">
                                <input type="color" id="backgroundColorPicker" class="color-picker" value="#ffffff">
                                <input type="text" id="backgroundColorHex" class="dimension-input" value="#ffffff" maxlength="7">
                            </div>
                            
                            <div class="color-presets">
                                <div class="color-preset active" style="background-color: #ffffff;" data-color="#ffffff"></div>
                                <div class="color-preset" style="background-color: #f5f5f7;" data-color="#f5f5f7"></div>
                                <div class="color-preset" style="background-color: #007AFF;" data-color="#007AFF"></div>
                                <div class="color-preset" style="background-color: #10b981;" data-color="#10b981"></div>
                                <div class="color-preset" style="background-color: #8b5cf6;" data-color="#8b5cf6"></div>
                                <div class="color-preset" style="background-color: #0a0a0a;" data-color="#0a0a0a"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-group" id="logoBlock">
                        <div class="control-header" data-target="logoContent">
                            <div class="control-title">
                                <span class="control-icon">üè∑Ô∏è</span>
                                Logo
                            </div>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="control-content" id="logoContent">
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Opacidade do Logo</span>
                                    <span class="slider-value" id="opacityValue">100%</span>
                                </div>
                                <input type="range" min="10" max="100" value="100" class="slider" id="opacitySlider">
                            </div>
                            
                            <div class="form-group mt-2">
                                <label class="form-label">Posi√ß√£o do Logo</label>
                                <div style="display: flex; gap: 6px;">
                                    <button class="aspect-button active" id="logoOnTopButton" style="flex: 1; padding: 6px;">Acima</button>
                                    <button class="aspect-button" id="logoUnderButton" style="flex: 1; padding: 6px;">Abaixo</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-group" id="watermarkBlock">
                        <div class="control-header" data-target="watermarkContent">
                            <div class="control-title">
                                <span class="control-icon">üíß</span>
                                Marca d'√Ågua
                            </div>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="control-content" id="watermarkContent">
                            <div class="form-group">
                                <label class="form-label">Texto da marca d'√°gua</label>
                                <input type="text" id="watermarkText" class="form-input" placeholder="Digite seu texto..." maxlength="30">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Tamanho do texto</span>
                                    <span class="slider-value" id="watermarkSizeValue">24px</span>
                                </div>
                                <input type="range" min="10" max="50" value="24" class="slider" id="watermarkSizeSlider">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label">
                                    <span class="slider-label-text">Opacidade do texto</span>
                                    <span class="slider-value" id="watermarkOpacityValue">30%</span>
                                </div>
                                <input type="range" min="5" max="100" value="30" class="slider" id="watermarkOpacitySlider">
                            </div>
                            
                            <div class="form-group mt-2">
                                <label class="form-label">Posi√ß√£o</label>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px;">
                                    <button class="aspect-button" data-position="top-left">‚Üñ</button>
                                    <button class="aspect-button" data-position="top-center">‚Üë</button>
                                    <button class="aspect-button" data-position="top-right">‚Üó</button>
                                    <button class="aspect-button" data-position="center">‚®Å</button>
                                    <button class="aspect-button active" data-position="bottom-left">‚Üô</button>
                                    <button class="aspect-button" data-position="bottom-center">‚Üì</button>
                                    <button class="aspect-button" data-position="bottom-right">‚Üò</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="right-column">
                <div class="card card-no-header">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div class="extractor-compact">
                            <div class="extractor-header">
                                <div class="extractor-header-title">
                                    <span style="width: 32px; height: 22px; display: flex; align-items: center; justify-content: center; background: var(--mercado-livre); border-radius: 4px; color: #1a1a1a;">ü§ùüèª</span>
                                    Mercado Livre
                                </div>
                                <button class="primary-button mercado-livre-button extractor-header-button" id="extractMercadoLivreButton">
                                    <span>üîç</span>
                                    Extrair
                                </button>
                            </div>
                            <div class="extractor-input-group">
                                <input type="text" id="mercadoLivreUrl" class="text-input" 
                                       placeholder="Produto do Mercado Livre..."
                                       style="width: 100%;">
                            </div>
                        </div>
                        
                        <div class="extractor-compact">
                            <div class="extractor-header">
                                <div class="extractor-header-title">
                                    <span style="width: 32px; height: 22px; display: flex; align-items: center; justify-content: center; background: var(--amazon); border-radius: 4px; color: white;">üì¶</span>
                                    Amazon
                                </div>
                                <button class="primary-button amazon-button extractor-header-button" id="extractAmazonButton">
                                    <span>üîç</span>
                                    Extrair
                                </button>
                            </div>
                            <div class="extractor-input-group">
                                <input type="text" id="amazonUrl" class="text-input" 
                                       placeholder="Produto da Amazon..."
                                       style="width: 100%;">
                            </div>
                        </div>
                    </div>
                    
                    <div class="status-message" id="extractorStatus" style="margin-top: 12px;"></div>
                </div>
                
                <div class="card card-no-header">
                    <form class="product-form">
                        <div class="form-group">
                            <label class="form-label">
                                <span class="form-label-icon">üî•</span>
                                T√çTULO
                            </label>
                            <textarea id="productTitle" class="form-textarea" placeholder="T√≠tulo do produto..." rows="2"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="form-label-icon">üíµ</span>
                                PRE√áO
                            </label>
                            <div style="display: flex; align-items: center; position: relative;">
                                <span style="position: absolute; left: 14px; color: var(--text-primary); font-weight: 500; z-index: 1; pointer-events: none;">R$</span>
                                <input type="text" id="productPrice" class="form-input" 
                                       placeholder="0,00" maxlength="20" 
                                       style="padding-left: 32px; width: 100%;">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="form-label-icon">‚≠ê</span>
                                CONDI√á√ïES
                            </label>
                            <select id="productInterest" class="form-input" style="cursor: pointer;">
                                <option value="">Selecione...</option>
                                <option value="√Ä vista">√Ä vista</option>
                                <option value="Pix">Pix</option>
                                <option value="1x sem juros">1x sem juros</option>
                                <option value="2x sem juros">2x sem juros</option>
                                <option value="3x sem juros">3x sem juros</option>
                                <option value="4x sem juros">4x sem juros</option>
                                <option value="5x sem juros">5x sem juros</option>
                                <option value="6x sem juros">6x sem juros</option>
                                <option value="7x sem juros">7x sem juros</option>
                                <option value="8x sem juros">8x sem juros</option>
                                <option value="9x sem juros">9x sem juros</option>
                                <option value="10x sem juros">10x sem juros</option>
                                <option value="11x sem juros">11x sem juros</option>
                                <option value="12x sem juros">12x sem juros</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="form-label-icon">üéüÔ∏è</span>
                                CUPOM
                            </label>
                            <input type="text" id="productCoupon" class="form-input" placeholder="Ex: CUPOM10" maxlength="40">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="form-label-icon">‚ö†Ô∏è</span>
                                AVISO
                            </label>
                            <input type="text" id="productWarningAfter" class="form-input" placeholder="Ex: V√°lido at√© 31/12" maxlength="50">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <span class="form-label-icon">üõí</span>
                                LINK PRODUTO
                            </label>
                            <input type="url" id="productLink" class="form-input" placeholder="https://exemplo.com/produto">
                        </div>
                    </form>
                </div>
                
                <div class="card copyable-area">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-title-icon">üìã</span>
                            Texto gerado
                        </h2>
                    </div>
                    <div class="card-body">
                        <textarea id="copyableText" class="copyable-textarea" readonly 
                                  placeholder="Copie o texto gerado..."></textarea>
                    </div>
                </div>
                
                <div class="card mt-4">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-title-icon">üì∑</span>
                            Upload de imagens
                        </h2>
                    </div>
                    <div class="card-body">
                        <div class="upload-options">
                            <div class="upload-option" onclick="document.getElementById('fileInput').click()">
                                <div class="upload-icon">üìÅ</div>
                                <p class="upload-text">Upload de imagem</p>
                                <input type="file" id="fileInput" accept="image/*" class="hidden">
                                <label for="fileInput" class="upload-button">Selecionar</label>
                            </div>
                            
                            <div class="upload-option" onclick="document.getElementById('logoInput').click()">
                                <div class="upload-icon">üè∑Ô∏è</div>
                                <p class="upload-text">Upload de logo</p>
                                <input type="file" id="logoInput" accept="image/*" class="hidden">
                                <label for="logoInput" class="upload-button">Selecionar</label>
                            </div>
                            
                            <div class="upload-option">
                                <div class="upload-icon">üîó</div>
                                <p class="upload-text">URL ou Colar</p>
                                <button class="upload-button" id="pasteButton">Colar imagem</button>
                                <div class="url-input-container">
                                    <input type="url" id="urlInput" class="url-input" placeholder="URL da imagem">
                                    <button class="upload-button" id="loadUrlButton" style="padding: 6px 10px;">Carregar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="app-footer">
            <p class="footer-text">
                <span class="footer-highlight">Febs IA</span> ‚Ä¢ Ferramenta de extra√ß√£o
                <br>
                Suporte a links encurtados ‚Ä¢ Interface premium ‚Ä¢ Desenvolvido com ‚ù§Ô∏è
            </p>
        </footer>
    </div>

    <script>
        const BACKEND_URL = 'https://ferramenta-s3vf.onrender.com/';
        
        const themeToggle = document.getElementById('themeToggle');
        const resultCanvas = document.getElementById('resultCanvas');
        const resultContainer = document.getElementById('resultContainer');
        const canvasPlaceholder = document.querySelector('.canvas-placeholder');
        
        const resetButton = document.getElementById('resetButton');
        const copyImageButton = document.getElementById('copyImageButton');
        const copyTextButton = document.getElementById('copyTextButton');
        
        const sizeSlider = document.getElementById('sizeSlider');
        const sizeValue = document.getElementById('sizeValue');
        const borderSlider = document.getElementById('borderSlider');
        const borderValue = document.getElementById('borderValue');
        const shadowSlider = document.getElementById('shadowSlider');
        const shadowValue = document.getElementById('shadowValue');
        const positionXSlider = document.getElementById('positionXSlider');
        const positionXValue = document.getElementById('positionXValue');
        const positionYSlider = document.getElementById('positionYSlider');
        const positionYValue = document.getElementById('positionYValue');
        const opacitySlider = document.getElementById('opacitySlider');
        const opacityValue = document.getElementById('opacityValue');
        const watermarkSizeSlider = document.getElementById('watermarkSizeSlider');
        const watermarkSizeValue = document.getElementById('watermarkSizeValue');
        const watermarkOpacitySlider = document.getElementById('watermarkOpacitySlider');
        const watermarkOpacityValue = document.getElementById('watermarkOpacityValue');
        
        const backgroundColorPicker = document.getElementById('backgroundColorPicker');
        const backgroundColorHex = document.getElementById('backgroundColorHex');
        const watermarkText = document.getElementById('watermarkText');
        
        const controlGroups = document.querySelectorAll('.control-group');
        const colorPresets = document.querySelectorAll('.color-preset');
        const aspectButtons = document.querySelectorAll('.aspect-button');
        const logoOnTopButton = document.getElementById('logoOnTopButton');
        const logoUnderButton = document.getElementById('logoUnderButton');
        
        const mercadoLivreUrlInput = document.getElementById('mercadoLivreUrl');
        const amazonUrlInput = document.getElementById('amazonUrl');
        const extractMercadoLivreButton = document.getElementById('extractMercadoLivreButton');
        const extractAmazonButton = document.getElementById('extractAmazonButton');
        const extractorStatus = document.getElementById('extractorStatus');
        
        const productTitle = document.getElementById('productTitle');
        const productPrice = document.getElementById('productPrice');
        const productInterest = document.getElementById('productInterest');
        const productCoupon = document.getElementById('productCoupon');
        const productWarningAfter = document.getElementById('productWarningAfter');
        const productLink = document.getElementById('productLink');
        
        const copyableText = document.getElementById('copyableText');
        
        const fileInput = document.getElementById('fileInput');
        const logoInput = document.getElementById('logoInput');
        const pasteButton = document.getElementById('pasteButton');
        const urlInput = document.getElementById('urlInput');
        const loadUrlButton = document.getElementById('loadUrlButton');
        
        let originalImage = null;
        let logoImage = null;
        let processedImageUrl = null;
        let imageSizePercent = 80;
        let borderRadius = 30;
        let shadowIntensity = 0;
        let logoOpacity = 100;
        let logoOnTop = true;
        let backgroundColor = '#ffffff';
        let watermarkFontSize = 24;
        let watermarkOpacity = 30;
        let watermarkPosition = 'bottom-left';
        let canvasWidth = 800;
        let canvasHeight = 400;
        let aspectRatio = '2:1';
        let imagePositionX = 0;
        let imagePositionY = 0;
        let originalCopyImageText = 'Copiar imagem';
        
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            initControls();
            initExtractor();
            initUpload();
            initEvents();
            updateCopyableText();
            
            document.addEventListener('paste', handleGlobalPaste);
            
            watermarkOpacityValue.textContent = `${watermarkOpacity}%`;
        });
        
        async function handleGlobalPaste(e) {
            const items = e.clipboardData?.items;
            if (!items) return;
            
            for (const item of items) {
                if (item.type.startsWith('image/')) {
                    e.preventDefault();
                    
                    const blob = item.getAsFile();
                    if (blob) {
                        const imageUrl = URL.createObjectURL(blob);
                        await loadImageFromBlob(blob, imageUrl, 'product');
                        showNotification('Imagem colada com Ctrl+V!', 'success');
                        break;
                    }
                }
            }
        }
        
        function initTheme() {
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                themeToggle.checked = true;
            }
            
            themeToggle.addEventListener('change', function() {
                if (this.checked) {
                    document.body.classList.add('dark-mode');
                    localStorage.setItem('darkMode', 'true');
                } else {
                    document.body.classList.remove('dark-mode');
                    localStorage.setItem('darkMode', 'false');
                }
            });
        }
        
        function initControls() {
            controlGroups.forEach(group => {
                const header = group.querySelector('.control-header');
                const content = group.querySelector('.control-content');
                
                header.addEventListener('click', () => {
                    const isOpen = group.classList.contains('open');
                    
                    controlGroups.forEach(g => {
                        if (g !== group) {
                            g.classList.remove('open');
                            g.querySelector('.control-content').style.display = 'none';
                        }
                    });
                    
                    if (!isOpen) {
                        group.classList.add('open');
                        content.style.display = 'block';
                    } else {
                        group.classList.remove('open');
                        content.style.display = 'none';
                    }
                });
            });
            
            sizeSlider.addEventListener('input', () => {
                imageSizePercent = parseInt(sizeSlider.value);
                sizeValue.textContent = `${imageSizePercent}%`;
                if (originalImage) processImage();
            });
            
            borderSlider.addEventListener('input', () => {
                borderRadius = parseInt(borderSlider.value);
                borderValue.textContent = `${borderRadius}px`;
                if (originalImage) processImage();
            });
            
            shadowSlider.addEventListener('input', () => {
                shadowIntensity = parseInt(shadowSlider.value);
                shadowValue.textContent = `${shadowIntensity}px`;
                if (originalImage) processImage();
            });
            
            positionXSlider.addEventListener('input', () => {
                imagePositionX = parseInt(positionXSlider.value);
                positionXValue.textContent = `${imagePositionX}px`;
                if (originalImage) processImage();
            });
            
            positionYSlider.addEventListener('input', () => {
                imagePositionY = parseInt(positionYSlider.value);
                positionYValue.textContent = `${imagePositionY}px`;
                if (originalImage) processImage();
            });
            
            opacitySlider.addEventListener('input', () => {
                logoOpacity = parseInt(opacitySlider.value);
                opacityValue.textContent = `${logoOpacity}%`;
                if (originalImage) processImage();
            });
            
            watermarkSizeSlider.addEventListener('input', () => {
                watermarkFontSize = parseInt(watermarkSizeSlider.value);
                watermarkSizeValue.textContent = `${watermarkFontSize}px`;
                if (originalImage) processImage();
            });
            
            watermarkOpacitySlider.addEventListener('input', () => {
                watermarkOpacity = parseInt(watermarkOpacitySlider.value);
                watermarkOpacityValue.textContent = `${watermarkOpacity}%`;
                if (originalImage) processImage();
            });
            
            document.getElementById('resetPositionButton').addEventListener('click', () => {
                imagePositionX = 0;
                imagePositionY = 0;
                positionXSlider.value = 0;
                positionYSlider.value = 0;
                positionXValue.textContent = '0px';
                positionYValue.textContent = '0px';
                if (originalImage) processImage();
            });
            
            backgroundColorPicker.addEventListener('input', () => {
                backgroundColor = backgroundColorPicker.value;
                backgroundColorHex.value = backgroundColor;
                updateColorPresets();
                if (originalImage) processImage();
            });
            
            backgroundColorHex.addEventListener('input', () => {
                let color = backgroundColorHex.value;
                if (!color.startsWith('#')) color = '#' + color;
                if (/^#[0-9A-F]{6}$/i.test(color)) {
                    backgroundColor = color;
                    backgroundColorPicker.value = color;
                    updateColorPresets();
                    if (originalImage) processImage();
                }
            });
            
            colorPresets.forEach(preset => {
                preset.addEventListener('click', () => {
                    backgroundColor = preset.getAttribute('data-color');
                    backgroundColorPicker.value = backgroundColor;
                    backgroundColorHex.value = backgroundColor;
                    updateColorPresets();
                    if (originalImage) processImage();
                });
            });
            
            logoOnTopButton.addEventListener('click', () => {
                logoOnTop = true;
                logoOnTopButton.classList.add('active');
                logoUnderButton.classList.remove('active');
                if (originalImage) processImage();
            });
            
            logoUnderButton.addEventListener('click', () => {
                logoOnTop = false;
                logoOnTopButton.classList.remove('active');
                logoUnderButton.classList.add('active');
                if (originalImage) processImage();
            });
            
            document.querySelectorAll('[data-position]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('[data-position]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    watermarkPosition = btn.getAttribute('data-position');
                    if (originalImage) processImage();
                });
            });
            
            document.querySelectorAll('.aspect-button[data-aspect]').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.aspect-button[data-aspect]').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    aspectRatio = btn.getAttribute('data-aspect');
                    canvasWidth = parseInt(btn.getAttribute('data-width'));
                    canvasHeight = parseInt(btn.getAttribute('data-height'));
                    
                    document.getElementById('customWidthPixels').value = canvasWidth;
                    document.getElementById('customHeightPixels').value = canvasHeight;
                    
                    if (originalImage) processImage();
                });
            });
            
            document.getElementById('applyCustomPixels').addEventListener('click', () => {
                const newWidth = parseInt(document.getElementById('customWidthPixels').value);
                const newHeight = parseInt(document.getElementById('customHeightPixels').value);
                
                if (isNaN(newWidth) || isNaN(newHeight) || newWidth < 100 || newWidth > 2000 || newHeight < 100 || newHeight > 2000) {
                    showNotification('Valores inv√°lidos! Use entre 100 e 2000 pixels.', 'error');
                    return;
                }
                
                canvasWidth = newWidth;
                canvasHeight = newHeight;
                
                document.querySelectorAll('.aspect-button[data-aspect]').forEach(b => b.classList.remove('active'));
                
                if (originalImage) processImage();
            });
            
            const widthInput = document.getElementById('customWidthPixels');
            const heightInput = document.getElementById('customHeightPixels');
            
            widthInput.addEventListener('change', () => {
                let value = parseInt(widthInput.value);
                if (value < 100) value = 100;
                if (value > 2000) value = 2000;
                widthInput.value = value;
                canvasWidth = value;
                document.querySelectorAll('.aspect-button[data-aspect]').forEach(b => b.classList.remove('active'));
                if (originalImage) processImage();
            });
            
            heightInput.addEventListener('change', () => {
                let value = parseInt(heightInput.value);
                if (value < 100) value = 100;
                if (value > 2000) value = 2000;
                heightInput.value = value;
                canvasHeight = value;
                document.querySelectorAll('.aspect-button[data-aspect]').forEach(b => b.classList.remove('active'));
                if (originalImage) processImage();
            });
        }
        
        function updateColorPresets() {
            colorPresets.forEach(preset => {
                const presetColor = preset.getAttribute('data-color');
                preset.classList.toggle('active', presetColor === backgroundColor);
            });
        }
        
        function initExtractor() {
            extractMercadoLivreButton.addEventListener('click', () => extractProductData('mercado-livre'));
            extractAmazonButton.addEventListener('click', () => extractProductData('amazon'));
            
            mercadoLivreUrlInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') extractProductData('mercado-livre');
            });
            
            amazonUrlInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') extractProductData('amazon');
            });
        }
        
        async function extractProductData(extractorType) {
            let url, extractButton;
            
            if (extractorType === 'mercado-livre') {
                url = mercadoLivreUrlInput.value.trim();
                extractButton = extractMercadoLivreButton;
            } else {
                url = amazonUrlInput.value.trim();
                extractButton = extractAmazonButton;
            }
            
            if (!url) {
                showNotification('Por favor, cole um link do produto', 'error');
                return;
            }
            
            extractButton.disabled = true;
            const originalText = extractButton.innerHTML;
            extractButton.innerHTML = '<div class="loading"></div>';
            
            showExtractorStatus('Conectando ao servidor...', 'info');
            
            try {
                const endpoint = extractorType === 'mercado-livre' ? '/api/extract' : '/api/extract-amazon';
                const response = await fetch(`${BACKEND_URL}${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    populateProductFields(data, url, extractorType);
                    
                    if (data.pictures && data.pictures.length > 0) {
                        await loadProductImage(data.pictures[0].url);
                    } else if (data.thumbnail) {
                        await loadProductImage(data.thumbnail);
                    }
                    
                    showExtractorStatus(`‚úÖ Dados extra√≠dos com sucesso`, 'success');
                    showNotification(`${extractorType === 'mercado-livre' ? 'Mercado Livre' : 'Amazon'} extra√≠do!`, 'success');
                    
                    extractButton.innerHTML = '<span>‚úÖ</span> Extra√≠do';
                    setTimeout(() => extractButton.innerHTML = originalText, 2000);
                    
                } else {
                    showExtractorStatus(`‚ùå ${data.message || 'Erro ao extrair dados'}`, 'error');
                }
            } catch (error) {
                console.error('Erro:', error);
                showExtractorStatus('‚ùå Erro de conex√£o com o servidor', 'error');
            } finally {
                extractButton.disabled = false;
                extractButton.innerHTML = originalText;
            }
        }
        
        function populateProductFields(productData, originalUrl, extractorType) {
            let extractedTitle = '';
            if (productData.title && productData.title !== 'Produto n√£o encontrado') {
                extractedTitle = productData.title;
            } else if (productData.name) {
                extractedTitle = productData.name;
            } else {
                extractedTitle = extractorType === 'mercado-livre' ? 'Produto Mercado Livre' : 'Produto Amazon';
            }
            
            const suffixes = ['| Mercado Livre', '- Mercado Livre', '| Amazon.com.br', '- Amazon.com.br'];
            suffixes.forEach(suffix => {
                if (extractedTitle.includes(suffix)) {
                    extractedTitle = extractedTitle.split(suffix)[0].trim();
                }
            });
            
            productTitle.value = extractedTitle;
            
            let extractedPrice = '';
            if (productData.formatted_price && productData.formatted_price !== 'Pre√ßo n√£o dispon√≠vel') {
                extractedPrice = productData.formatted_price
                    .replace('R$', '')
                    .replace('R$ ', '')
                    .trim();
                
                extractedPrice = extractedPrice.replace(/\./g, '');
                
                if (!extractedPrice.includes(',')) {
                    const numMatch = extractedPrice.match(/(\d+)/);
                    if (numMatch) {
                        extractedPrice = numMatch[1] + ',00';
                    }
                }
            } else if (productData.price) {
                const priceNum = parseFloat(productData.price);
                if (!isNaN(priceNum)) {
                    extractedPrice = priceNum.toFixed(2).replace('.', ',');
                }
            }
            
            productPrice.value = extractedPrice || '0,00';
            
            productLink.value = originalUrl;
            
            updateCopyableText();
        }
        
        async function loadProductImage(imageUrl) {
            try {
                showExtractorStatus('üñºÔ∏è Carregando imagem...', 'info');
                
                const img = new Image();
                img.crossOrigin = "anonymous";
                
                img.onload = () => {
                    originalImage = img;
                    
                    setTimeout(() => {
                        processImage();
                        showExtractorStatus('‚úÖ Imagem carregada com sucesso', 'success');
                    }, 500);
                };
                
                img.onerror = () => {
                    showExtractorStatus('‚ö†Ô∏è Imagem n√£o encontrada', 'error');
                };
                
                img.src = imageUrl;
            } catch (error) {
                console.error('Erro ao carregar imagem:', error);
                showExtractorStatus('‚ùå Erro ao carregar imagem', 'error');
            }
        }
        
        function showExtractorStatus(message, type) {
            extractorStatus.textContent = message;
            extractorStatus.className = `status-message status-${type}`;
            extractorStatus.style.display = 'block';
            
            setTimeout(() => {
                extractorStatus.style.display = 'none';
            }, 5000);
        }
        
        function initUpload() {
            fileInput.addEventListener('change', e => {
                if (e.target.files && e.target.files[0]) {
                    loadImageFromFile(e.target.files[0], 'product');
                }
            });
            
            logoInput.addEventListener('change', e => {
                if (e.target.files && e.target.files[0]) {
                    loadImageFromFile(e.target.files[0], 'logo');
                }
            });
            
            pasteButton.addEventListener('click', async () => {
                try {
                    const clipboardItems = await navigator.clipboard.read();
                    for (const clipboardItem of clipboardItems) {
                        for (const type of clipboardItem.types) {
                            if (type.startsWith('image/')) {
                                const blob = await clipboardItem.getType(type);
                                const imageUrl = URL.createObjectURL(blob);
                                loadImageFromBlob(blob, imageUrl, 'product');
                                showNotification('Imagem colada com sucesso!', 'success');
                                return;
                            }
                        }
                    }
                    showNotification('Nenhuma imagem encontrada na √°rea de transfer√™ncia', 'error');
                } catch (error) {
                    console.error('Erro:', error);
                    showNotification('N√£o foi poss√≠vel acessar a √°rea de transfer√™ncia', 'error');
                }
            });
            
            loadUrlButton.addEventListener('click', () => {
                const url = urlInput.value.trim();
                if (!url) {
                    showNotification('Digite uma URL v√°lida', 'error');
                    return;
                }
                
                try {
                    new URL(url);
                    loadImageFromUrl(url);
                } catch {
                    showNotification('URL inv√°lida', 'error');
                }
            });
            
            urlInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') loadUrlButton.click();
            });
        }
        
        function loadImageFromFile(file, type) {
            if (!file.type.match('image.*')) {
                showNotification('Arquivo inv√°lido. Selecione uma imagem.', 'error');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showNotification('Arquivo muito grande. M√°ximo: 10MB', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = e => {
                const img = new Image();
                img.onload = () => {
                    if (type === 'product') {
                        originalImage = img;
                        processImage();
                        showNotification('Imagem carregada com sucesso!', 'success');
                    } else if (type === 'logo') {
                        logoImage = img;
                        showNotification('Logo carregado com sucesso!', 'success');
                    }
                    updateCopyableText();
                };
                img.onerror = () => showNotification('Erro ao carregar imagem', 'error');
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        function loadImageFromBlob(blob, imageUrl, type) {
            const img = new Image();
            img.onload = () => {
                if (type === 'product') {
                    originalImage = img;
                    processImage();
                }
                URL.revokeObjectURL(imageUrl);
            };
            img.onerror = () => {
                showNotification('Erro ao carregar imagem', 'error');
                URL.revokeObjectURL(imageUrl);
            };
            img.src = imageUrl;
        }
        
        function loadImageFromUrl(url) {
            loadUrlButton.disabled = true;
            const originalText = loadUrlButton.innerHTML;
            loadUrlButton.innerHTML = '<div class="loading"></div>';
            
            const img = new Image();
            img.crossOrigin = "anonymous";
            img.onload = () => {
                originalImage = img;
                loadUrlButton.disabled = false;
                loadUrlButton.innerHTML = originalText;
                processImage();
                showNotification('Imagem carregada da URL!', 'success');
                updateCopyableText();
            };
            img.onerror = () => {
                showNotification('Erro ao carregar imagem da URL', 'error');
                loadUrlButton.disabled = false;
                loadUrlButton.innerHTML = originalText;
            };
            img.src = url;
        }
        
        function processImage() {
            if (!originalImage) return;
            
            resultCanvas.width = canvasWidth;
            resultCanvas.height = canvasHeight;
            const ctx = resultCanvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);
            
            ctx.fillStyle = backgroundColor;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
            
            const imageMaxWidth = canvasWidth * (imageSizePercent / 100);
            const imageMaxHeight = canvasHeight * (imageSizePercent / 100);
            const imageAspectRatio = originalImage.width / originalImage.height;
            const targetAspectRatio = imageMaxWidth / imageMaxHeight;
            
            let drawWidth, drawHeight;
            
            if (imageAspectRatio > targetAspectRatio) {
                drawWidth = imageMaxWidth;
                drawHeight = drawWidth / imageAspectRatio;
            } else {
                drawHeight = imageMaxHeight;
                drawWidth = drawHeight * imageAspectRatio;
            }
            
            let offsetX = (canvasWidth - drawWidth) / 2;
            let offsetY = (canvasHeight - drawHeight) / 2;
            
            const maxXOffset = (canvasWidth - drawWidth) / 2;
            offsetX += (imagePositionX / 100) * maxXOffset;
            
            const maxYOffset = (canvasHeight - drawHeight) / 2;
            offsetY += (imagePositionY / 100) * maxYOffset;
            
            offsetX = Math.max(-drawWidth * 0.5, Math.min(canvasWidth - drawWidth * 0.5, offsetX));
            offsetY = Math.max(-drawHeight * 0.5, Math.min(canvasHeight - drawHeight * 0.5, offsetY));
            
            if (shadowIntensity > 0) {
                ctx.save();
                ctx.shadowColor = 'rgba(0, 0, 0, 0.15)';
                ctx.shadowBlur = shadowIntensity;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = shadowIntensity / 3;
                
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = drawWidth;
                tempCanvas.height = drawHeight;
                
                tempCtx.fillStyle = 'rgba(0, 0, 0, 0.6)';
                drawRoundedRect(tempCtx, 0, 0, drawWidth, drawHeight, borderRadius);
                tempCtx.fill();
                
                ctx.drawImage(tempCanvas, offsetX, offsetY);
                ctx.restore();
            }
            
            ctx.save();
            drawRoundedRect(ctx, offsetX, offsetY, drawWidth, drawHeight, borderRadius);
            ctx.clip();
            ctx.drawImage(originalImage, offsetX, offsetY, drawWidth, drawHeight);
            ctx.restore();
            
            if (logoImage) {
                ctx.save();
                ctx.globalAlpha = logoOpacity / 100;
                
                const logoAspectRatio = logoImage.width / logoImage.height;
                const canvasAspectRatio = canvasWidth / canvasHeight;
                
                let logoDrawWidth, logoDrawHeight, logoOffsetX, logoOffsetY;
                
                if (logoAspectRatio > canvasAspectRatio) {
                    logoDrawHeight = canvasHeight;
                    logoDrawWidth = logoImage.width * (canvasHeight / logoImage.height);
                    logoOffsetX = (canvasWidth - logoDrawWidth) / 2;
                    logoOffsetY = 0;
                } else {
                    logoDrawWidth = canvasWidth;
                    logoDrawHeight = logoImage.height * (canvasWidth / logoImage.width);
                    logoOffsetX = 0;
                    logoOffsetY = (canvasHeight - logoDrawHeight) / 2;
                }
                
                if (logoOnTop) {
                    ctx.drawImage(logoImage, logoOffsetX, logoOffsetY, logoDrawWidth, logoDrawHeight);
                } else {
                    ctx.drawImage(logoImage, logoOffsetX, logoOffsetY, logoDrawWidth, logoDrawHeight);
                }
                
                ctx.restore();
            }
            
            const watermark = watermarkText.value.trim();
            if (watermark) {
                ctx.save();
                ctx.font = `500 ${watermarkFontSize}px ${getComputedStyle(document.body).fontFamily}`;
                
                const bgColor = backgroundColor.toLowerCase();
                const isLightColor = bgColor === '#ffffff' || 
                    (bgColor.startsWith('#') && 
                     (parseInt(bgColor.slice(1, 3), 16) > 200 ||
                      parseInt(bgColor.slice(3, 5), 16) > 200 ||
                      parseInt(bgColor.slice(5, 7), 16) > 200));
                
                ctx.fillStyle = isLightColor ? `rgba(0, 0, 0, ${watermarkOpacity / 100 * 0.5})` : `rgba(255, 255, 255, ${watermarkOpacity / 100 * 0.5})`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                let x, y;
                const padding = 24;
                
                switch (watermarkPosition) {
                    case 'top-left':
                        x = padding; y = padding;
                        ctx.textAlign = 'left'; ctx.textBaseline = 'top';
                        break;
                    case 'top-center':
                        x = canvasWidth / 2; y = padding;
                        ctx.textBaseline = 'top';
                        break;
                    case 'top-right':
                        x = canvasWidth - padding; y = padding;
                        ctx.textAlign = 'right'; ctx.textBaseline = 'top';
                        break;
                    case 'center':
                        x = canvasWidth / 2; y = canvasHeight / 2;
                        break;
                    case 'bottom-left':
                        x = padding; y = canvasHeight - padding;
                        ctx.textAlign = 'left'; ctx.textBaseline = 'bottom';
                        break;
                    case 'bottom-center':
                        x = canvasWidth / 2; y = canvasHeight - padding;
                        ctx.textBaseline = 'bottom';
                        break;
                    case 'bottom-right':
                        x = canvasWidth - padding; y = canvasHeight - padding;
                        ctx.textAlign = 'right'; ctx.textBaseline = 'bottom';
                        break;
                }
                
                ctx.fillText(watermark, x, y);
                ctx.restore();
            }
            
            resultCanvas.style.display = 'block';
            canvasPlaceholder.style.display = 'none';
            resultContainer.classList.add('has-image');
            copyImageButton.disabled = false;
            
            if (processedImageUrl) {
                URL.revokeObjectURL(processedImageUrl);
            }
            
            resultCanvas.toBlob(blob => {
                processedImageUrl = URL.createObjectURL(blob);
            });
        }
        
        function drawRoundedRect(ctx, x, y, width, height, radius) {
            if (radius === 0) {
                ctx.rect(x, y, width, height);
                return;
            }
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
        }
        
        function initEvents() {
            copyImageButton.addEventListener('click', async () => {
                if (!processedImageUrl) {
                    showNotification('Nenhuma imagem dispon√≠vel para copiar', 'error');
                    return;
                }
                
                try {
                    const response = await fetch(processedImageUrl);
                    const blob = await response.blob();
                    const clipboardItem = new ClipboardItem({ [blob.type]: blob });
                    await navigator.clipboard.write([clipboardItem]);
                    showNotification('Imagem copiada para a √°rea de transfer√™ncia!', 'success');
                    
                    const originalText = copyImageButton.innerHTML;
                    copyImageButton.innerHTML = '<span class="copy-button-icon">‚úÖ</span> Copiado!';
                    copyImageButton.style.background = 'var(--status-success)';
                    copyImageButton.style.borderColor = 'var(--status-success)';
                    
                    setTimeout(() => {
                        copyImageButton.innerHTML = originalCopyImageText;
                        copyImageButton.style.background = '';
                        copyImageButton.style.borderColor = '';
                    }, 2000);
                    
                } catch (error) {
                    console.error('Erro ao copiar imagem:', error);
                    showNotification('Erro ao copiar imagem', 'error');
                }
            });
            
            copyTextButton.addEventListener('click', async () => {
                const textToCopy = copyableText.value.trim();
                
                if (!textToCopy) {
                    showNotification('Nenhum texto dispon√≠vel para copiar', 'error');
                    return;
                }
                
                try {
                    await navigator.clipboard.writeText(textToCopy);
                    showNotification('Texto copiado para a √°rea de transfer√™ncia!', 'success');
                    
                    copyableText.classList.add('copied');
                    const originalText = copyTextButton.innerHTML;
                    copyTextButton.innerHTML = '<span class="copy-button-icon">‚úÖ</span> Copiado!';
                    
                    setTimeout(() => {
                        copyableText.classList.remove('copied');
                        copyTextButton.innerHTML = originalText;
                    }, 2000);
                    
                } catch (error) {
                    console.error('Erro ao copiar texto:', error);
                    showNotification('Erro ao copiar texto. Selecione e copie manualmente.', 'error');
                }
            });
            
            resetButton.addEventListener('click', resetAll);
            
            const productInputs = [productTitle, productPrice, productInterest, productCoupon, productWarningAfter, productLink];
            productInputs.forEach(input => {
                input.addEventListener('input', updateCopyableText);
            });
            
            productInterest.addEventListener('change', function() {
                updateCopyableText();
            });
            
            copyableText.addEventListener('click', () => {
                copyableText.select();
            });
            
            productPrice.addEventListener('input', function(e) {
                let value = this.value.replace(/[^\d,]/g, '');
                
                const parts = value.split(',');
                if (parts.length > 2) {
                    value = parts[0] + ',' + parts.slice(1).join('');
                }
                
                if (parts.length === 2 && parts[1].length > 2) {
                    value = parts[0] + ',' + parts[1].substring(0, 2);
                }
                
                this.value = value;
                updateCopyableText();
            });
        }
        
        function updateCopyableText() {
            const title = productTitle.value.trim();
            const priceValue = productPrice.value.trim();
            const interest = productInterest.value.trim();
            const coupon = productCoupon.value.trim();
            const warningAfter = productWarningAfter.value.trim();
            const link = productLink.value.trim();
            
            let text = '';
            
            if (title) text += `üî• ${title}\n\n`;
            
            if (priceValue || interest === 'Pix' || interest === '√Ä vista') {
                let priceLine = `üíµ R$ ${priceValue || '0,00'}`;
                
                if (interest === 'Pix') {
                    priceLine += ' pix';
                    text += `${priceLine}\n`;
                } else if (interest === '√Ä vista') {
                    priceLine += ' √† vista';
                    text += `${priceLine}\n`;
                } else if (interest && interest !== 'Selecione...') {
                    text += `${priceLine}\n`;
                    text += `‚≠ê ${interest}\n`;
                } else {
                    text += `${priceLine}\n`;
                }
            }
            
            if (coupon) text += `üéüÔ∏è Cupom: ${coupon}\n`;
            
            if (warningAfter) text += `‚ö†Ô∏è ${warningAfter}\n`;
            
            if (link) {
                let cleanLink = link;
                cleanLink = cleanLink.replace(/^https?:\/\//i, '');
                text += `\n${cleanLink}\n`;
            }
            
            copyableText.value = text;
            copyTextButton.disabled = !text.trim();
        }
        
        function resetAll() {
            fileInput.value = '';
            logoInput.value = '';
            urlInput.value = '';
            mercadoLivreUrlInput.value = '';
            amazonUrlInput.value = '';
            
            const ctx = resultCanvas.getContext('2d');
            ctx.clearRect(0, 0, resultCanvas.width, resultCanvas.height);
            resultCanvas.style.display = 'none';
            canvasPlaceholder.style.display = 'block';
            resultContainer.classList.remove('has-image');
            
            document.querySelectorAll('.aspect-button[data-aspect]').forEach(btn => btn.classList.remove('active'));
            document.querySelector('.aspect-button[data-aspect="2:1"]').classList.add('active');
            aspectRatio = '2:1';
            canvasWidth = 800;
            canvasHeight = 400;
            document.getElementById('customWidthPixels').value = 800;
            document.getElementById('customHeightPixels').value = 400;
            
            sizeSlider.value = 80;
            imageSizePercent = 80;
            sizeValue.textContent = '80%';
            
            borderSlider.value = 30;
            borderRadius = 30;
            borderValue.textContent = '30px';
            
            shadowSlider.value = 0;
            shadowIntensity = 0;
            shadowValue.textContent = '0px';
            
            positionXSlider.value = 0;
            positionYSlider.value = 0;
            imagePositionX = 0;
            imagePositionY = 0;
            positionXValue.textContent = '0px';
            positionYValue.textContent = '0px';
            
            opacitySlider.value = 100;
            logoOpacity = 100;
            opacityValue.textContent = '100%';
            
            watermarkSizeSlider.value = 24;
            watermarkFontSize = 24;
            watermarkSizeValue.textContent = '24px';
            
            watermarkOpacitySlider.value = 30;
            watermarkOpacity = 30;
            watermarkOpacityValue.textContent = '30%';
            
            backgroundColorPicker.value = '#ffffff';
            backgroundColorHex.value = '#ffffff';
            backgroundColor = '#ffffff';
            updateColorPresets();
            
            logoOnTop = true;
            logoOnTopButton.classList.add('active');
            logoUnderButton.classList.remove('active');
            
            watermarkText.value = '';
            document.querySelectorAll('[data-position]').forEach(btn => btn.classList.remove('active'));
            document.querySelector('[data-position="bottom-left"]').classList.add('active');
            watermarkPosition = 'bottom-left';
            
            productTitle.value = '';
            productPrice.value = '';
            productInterest.value = '';
            productCoupon.value = '';
            productWarningAfter.value = '';
            productLink.value = '';
            
            extractorStatus.style.display = 'none';
            
            originalImage = null;
            logoImage = null;
            if (processedImageUrl) {
                URL.revokeObjectURL(processedImageUrl);
                processedImageUrl = null;
            }
            
            updateCopyableText();
            copyImageButton.disabled = true;
            
            copyImageButton.innerHTML = originalCopyImageText;
            copyImageButton.style.background = '';
            copyImageButton.style.borderColor = '';
            
            extractMercadoLivreButton.disabled = false;
            extractMercadoLivreButton.innerHTML = '<span>üîç</span> Extrair';
            extractAmazonButton.disabled = false;
            extractAmazonButton.innerHTML = '<span>üîç</span> Extrair';
            
            showNotification('Tudo foi resetado com sucesso!', 'success');
        }
        
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '1000';
            notification.style.maxWidth = '300px';
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 10);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>